define(["https://d2b1xqaw2ss8na.cloudfront.net/static/js/remote-control-bridge.js"],function(){"use strict";var e=document.createElement("link");return e.type="text/css",e.rel="stylesheet",e.href="https://embed.spotify.com/static/css/mediabar/mediabar-lastfm.css",document.getElementsByTagName("head")[0].appendChild(e),Spotify=function(e){return e.Popup=function(e){var t=this;"undefined"==typeof e.autoClose&&(e.autoClose=!1),"undefined"==typeof e.absolute&&(e.absolute=!0);var n={iframeSrc:e.iframeSrc||null,parentElement:e.parentElement||document.body,sourceElement:e.sourceElement||null,view:e.view||null,onAfterRender:e.onAfterRender||null,onBeforeShow:e.onBeforeShow||null,size:e.size||null,absolute:e.absolute,offset:e.offset||null,id:e.id||null,autoClose:e.autoClose,template:e.template||null,actions:e.actions||null,popupWindow:e.popupWindow?e.popupWindow:!1,onHideCallback:e.onHideCallback?e.onHideCallback:null},i=!1,o=null,r=null;this.show=function(){i||(o.children[0].style.display="block",null===n.iframeSrc&&(o.className=o.className+" spotify-show"),r||(r=Spotify.Util.byClassName("spotify-dialog",o)[0]),n.size&&n.size.length>0&&(r.style.width=n.size[0]+"px"),n.size&&n.size.length>1&&(r.style.height=n.size[1]+"px"),n.popupWindow||l(),Spotify.Util.attachEvent("resize",a),n.autoClose&&(Spotify.Util.attachEvent("keydown",f),Spotify.Util.attachEvent("click",f)),i=!0,"function"==typeof n.onBeforeShow&&n.onBeforeShow())},this.hide=function(){i&&(o.className=o.className.replace(" spotify-show",""),i=!1,window.removeEventListener&&(Spotify.Util.removeEvent("resize",a),n.autoClose&&(Spotify.Util.removeEvent("keydown",f),Spotify.Util.removeEvent("click",f))),"function"==typeof n.onHideCallback&&n.onHideCallback())},this.size=function(){return Spotify.Util.size(r)},this.destroyElement=function(){o&&Spotify.Util.removeNode(o)},this.overrideOptions=function(e,t){n[e]=t},this.getOptions=function(){return n},this.getContainer=function(){return r},this.setPosition=function(){l()},this.isVisible=function(){return i};var s=function(){var e=Spotify.View.render("iframe",{src:n.iframeSrc});return Spotify.Util.iframeReady(e,function(){o.className=o.className+" spotify-show"}),e},l=function(){var e=Spotify.Util.size(r);if("undefined"!=typeof n.absolute&&n.absolute&&(r.style.position="absolute",o.style.position="absolute"),n.sourceElement){var t=Spotify.Util.size(n.sourceElement),i=Spotify.Util.position(n.sourceElement),e=-1*(e[0]/2-t[0]/2),t=n.sourceElement.offsetHeight;n.offset&&(e+=n.offset[0],t+=n.offset[1]),Spotify.Util.setPosition(r,{x:i.x+e,y:i.y+t})}else e&&(i=Spotify.Util.getWindowSize(),r.style.top=parseInt(i[1],10)/2-e[1]/2+"px",r.style.marginLeft="-"+e[0]/2+"px")},a=function(){n.popupWindow||l()},f=function(e){i&&("click"===e.type||27==e.keyCode)&&t.hide()};!function(){if(o=Spotify.View.render("base-popup")){var e=null;if(n.iframeSrc?e=s():n.view?e=Spotify.View.render(n.view):n.template&&(e=n.template,Spotify.Util.removeNode(n.template)),o.children[0].style.display="none",o.children[0].appendChild(e),n.id&&(o.className=o.className+(" "+n.id)),n.parentElement.appendChild(o),"function"==typeof n.onAfterRender&&n.onAfterRender(o),"object"==typeof n.actions&&null!==n.actions){for(var t in n.actions)"function"==typeof n.actions[t]&&"onRender"!==t&&(e=null,e="."===t[0]?document.querySelector("#"+n.template.id+" "+t):document.getElementById(t),Spotify.Util.attachEvent("click",n.actions[t],e));"function"==typeof n.actions.onRender&&n.actions.onRender()}}}()},e}(Spotify||{}),Spotify=function(e){return e.View={render:function(e,t){"string"==typeof e&&(e=this.views[e]);var n=document.createElement(e.type),n=this.includeAttributes(n,e,t);return"undefined"!=typeof e.children?n=this.addChildren(n,e.children):"undefined"!=typeof e.content&&(n.innerHTML=e.content),n},renderResource:function(e){var t=null;switch(e.split(".").pop().toLowerCase()){case"css":t=this.render("css-node",{href:e});break;case"js":t=this.render("js-node",{src:e})}return t},renderAsText:function(e,t){return"string"==typeof e&&(e=this.views[e]),this._renderElementAsText(e,t)},includeAttributes:function(e,t,n){return"undefined"!=typeof t.randomId&&t.randomId&&(e.id=Spotify.Util.randomId()),e=this.applyAttributes(t.attributes,e),e=this.applyAttributes(n,e)},applyAttributes:function(e,t){if("undefined"!=typeof e)for(var n in e)e.hasOwnProperty(n)&&t.setAttribute(n,e[n]);return t},addChildren:function(e,t){for(var n=t.length,i=0;n>i;i++){var o=this.render(t[i]);e.appendChild(o)}return e},_renderElementAsText:function(e,t){function n(e){for(i in e)e.hasOwnProperty(i)&&r.push(i+'="'+Spotify.Util.toHtml(e[i])+'"')}var i,o=e.children||[],r=[],s=[];n(e.attributes||{}),n(t),e.randomId&&r.push('id="'+Spotify.Util.randomId()+'"');for(var l=0;l<o.length;l++)s.push(this._renderElementAsText(o[l]));return"<"+e.type+" "+r.join(" ")+">"+s.join("")+"</"+e.type+">"},views:{"base-popup":{type:"div",attributes:{"class":"spotify-popup"},randomId:!0,children:[{attributes:{"class":"spotify-dialog"},type:"div"}]},"js-node":{type:"script",attributes:{type:"text/javascript"}},iframe:{type:"iframe"},"css-node":{type:"link",attributes:{rel:"stylesheet",type:"text/css"}},loader:{type:"div",attributes:{"class":"spotify-throbber-small"}},"loader-big":{type:"div",attributes:{"class":"spotify-throbber-big"}},"iframe-share":{type:"iframe",attributes:{frameborder:0,allowtransparency:!0}}}},e}(Spotify||{}),Spotify=function(e){return e.Url={read:function(e){var t={};if("undefined"==typeof e)e=window.location.search.substr(1);else{var n=document.createElement("a");n.href=e,e=n.search.slice(1)}if(e)for(e=e.split("&"),n=0;n<e.length;n++){var i=e[n],o=i.indexOf("=");-1===o?t[decodeURIComponent(i)]="":t[decodeURIComponent(i.substr(0,o))]=decodeURIComponent(i.substr(o+1))}return t},generate:function(e,t,n){var t=this.queryFromObject(t),i="",i=(n||location.protocol)+e;return""!==t&&(i+="?"+t),i},queryFromObject:function(e){var t,n=[];for(t in e)null!=e[t]&&n.push(encodeURIComponent(t)+"="+encodeURIComponent(e[t]));return n.join("&")},addParameters:function(e,t){return e=-1===e.indexOf("?")?e+"?":e+"&",e+t}},e}(Spotify||{}),Spotify});